<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Webserv ¬∑ Blue Server</title>

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #0a1a2f, #0f2740, #081421);
        color: #e6f1ff;
    }

    header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 18px 30px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        background: rgba(0,40,80,0.4);
        backdrop-filter: blur(6px);
    }

    .title {
        font-size: 26px;
        font-weight: 600;
        color: #d8eaff;
    }

    .lang-switch {
        display: flex;
        gap: 10px;
    }

    .lang-switch button {
        background: rgba(180,220,255,0.1);
        border: 1px solid rgba(255,255,255,0.15);
        color: #e4f3ff;
        padding: 6px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 12px;
        transition: 0.2s;
    }
    .lang-switch button:hover {
        background: rgba(240,240,255,0.3);
    }

    main {
        max-width: 900px;
        margin: 40px auto;
        text-align: center;
        padding: 0 24px;
    }

    .card {
        background: rgba(0,40,80,0.55);
        border: 1px solid rgba(255,255,255,0.12);
        padding: 32px;
        border-radius: 20px;
        box-shadow: 0 10px 35px rgba(0,0,0,0.5);
        backdrop-filter: blur(10px);
    }

    h2 { margin-top: 0; font-size: 26px; color: #e6f3ff; }
    p { font-size: 15px; opacity: .9; }

    .method-grid {
        margin-top: 30px;
        display: grid;
        gap: 20px;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    }

    .method-btn {
        padding: 16px;
        background: rgba(150,200,255,0.10);
        border: 1px solid rgba(255,255,255,0.15);
        color: #eaf6ff;
        border-radius: 14px;
        font-size: 15px;
        cursor: pointer;
        transition: 0.2s;
    }
    .method-btn:hover {
        background: rgba(140,180,255,0.25);
    }

    .response-box {
        margin-top: 30px;
        padding: 16px;
        background: rgba(150,200,255,0.08);
        border: 1px solid rgba(255,255,255,0.18);
        border-radius: 12px;
        text-align: left;
        white-space: pre-wrap;
        font-family: monospace;
        font-size: 13px;
    }

    .input-box {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        text-align: left;
    }

    .input-box input[type="text"],
    .input-box input[type="file"] {
        padding: 8px;
        background: rgba(255,255,255,0.1);
        border: 1px solid rgba(255,255,255,0.25);
        border-radius: 6px;
        color: #eaf6ff;
    }

    .close-btn {
        background: transparent;
        border: none;
        color: #aac8ff;
        font-size: 18px;
        cursor: pointer;
    }
</style>
</head>



<body>
<header>
    <div class="title" id="title">Serveur Bleu</div>
    <div class="lang-switch">
        <button onclick="changeLang('fr')">FR</button>
        <button onclick="changeLang('en')">EN</button>
        <button onclick="changeLang('kr')">KR</button>
    </div>
</header>

<main>
    <section class="card" id="content-box">
        <h2 id="subtitle">Bienvenue üåä</h2>
        <p id="description">Serveur de test bleu ‚Äì Webserv demo page.</p>

        <div class="method-grid">
            <button class="method-btn" onclick="sendImage()">GET croissant ü•ê</button>
            <button class="method-btn" onclick="showPostForm()">POST Upload</button>
            <button class="method-btn" onclick="showDeleteForm()">DELETE File</button>
            <button class="method-btn" onclick="sendCGI()">CGI Test</button>
        </div>

        <div id="extra-ui"></div>

        <div class="response-box" id="response-display">
            ‚Üí Cliquez sur un bouton pour voir la r√©ponse HTTP ici.
        </div>
    </section>
</main>

<script>

/* ---------------- UTILITY (Í≥µÌÜµ Ï¥àÍ∏∞Ìôî) ---------------- */
function clearUI() {
    document.getElementById("extra-ui").innerHTML = "";
    document.getElementById("response-display").innerHTML =
        `‚Üí Cliquez sur un bouton pour voir la r√©ponse HTTP ici.`;
}


/* ---------------- LANGUAGE DATA ---------------- */
const translations = {
    fr: {
        title: "Serveur Bleu",
        subtitle: "Bienvenue ",
        desc: "Serveur de test bleu ‚Äì Page de d√©monstration Webserv.",
        deleteLabel: "DELETE chemin (ex: /upload/test.txt)",
        postLabel: "Upload fichier ‚Üí POST /upload",
        baguetteLabel: "Euro ‚Üí Baguette"
    },
    en: {
        title: "Blue Server",
        subtitle: "Welcome ",
        desc: "Blue test server ‚Äì Webserv demo page.",
        deleteLabel: "DELETE path (ex: /upload/test.txt)",
        postLabel: "Upload file ‚Üí POST /upload",
        baguetteLabel: "Euro ‚Üí Baguette"
    },
    kr: {
        title: "Ìë∏Î•∏ ÏÑúÎ≤Ñ",
        subtitle: "ÌôòÏòÅÌï©ÎãàÎã§ ",
        desc: "Ìë∏Î•∏ ÏÑúÎ≤Ñ ‚Äì Webserv ÌÖåÏä§Ìä∏ ÌéòÏù¥ÏßÄ.",
        deleteLabel: "ÏÇ≠Ï†úÌï† Í≤ΩÎ°ú (Ïòà: /upload/test.txt)",
        postLabel: "ÏóÖÎ°úÎìú ÌååÏùº ‚Üí POST /upload",
        baguetteLabel: "Ïú†Î°ú ‚Üí Î∞îÍ≤åÌä∏"
    }
};

function changeLang(lang) {
    // Set language in localStorage
    localStorage.setItem("lang", lang);

    const t = translations[lang];
    document.getElementById("title").innerText = t.title;
    document.getElementById("subtitle").innerText = t.subtitle;
    document.getElementById("description").innerText = t.desc;

    const deleteInput = document.getElementById("delete-label");
    const postLabel = document.getElementById("post-label");
    const baguette = document.getElementById("baguette-label");

    if (deleteInput) deleteInput.innerText = t.deleteLabel;
    if (postLabel) postLabel.innerText = t.postLabel;
    if (baguette) baguette.innerText = t.baguetteLabel;
}


/* ---------------- GET IMAGE ---------------- */
function sendImage() {
    clearUI();

    fetch("/images/croissant.png", { method: "GET" })
        .then(res => res.blob().then(b => ({status: res.status, blob:b})))
        .then(({status, blob}) => {

            const box = document.getElementById("response-display");
            const url = URL.createObjectURL(blob);

            box.innerHTML = `
                <div style="display:flex; justify-content:flex-end;">
                    <button class="close-btn" onclick="clearUI()">‚úñ</button>
                </div>

                <h3>GET /images/croissant.png ‚Üí status ${status}</h3>
                <img src="${url}" 
                     style="max-width:260px; border-radius:12px; margin-top:10px;">
            `;
        });
}



/* ---------------- POST FORM ---------------- */
function showPostForm() {
    clearUI();

    document.getElementById("extra-ui").innerHTML = `
        <div style="display:flex; justify-content:flex-end;">
            <button class="close-btn" onclick="clearUI()">‚úñ</button>
        </div>

        <div class="input-box">
            <label id="post-label">Upload file ‚Üí POST /upload</label>
            <input type="file" id="post-file">
            <button class="method-btn" onclick="sendPost()">Upload</button>
        </div>
    `;
}

function sendPost() {
    const file = document.getElementById("post-file").files[0];
    const form = new FormData();
    form.append("file", file);

    fetch("/upload", { method: "POST", body: form })
        .then(res => res.text().then(t => {
            document.getElementById("response-display").innerHTML = `
                <div style="display:flex; justify-content:flex-end;">
                    <button class="close-btn" onclick="clearUI()">‚úñ</button>
                </div>
                <h3>POST /upload ‚Üí status ${res.status}</h3>
                ${t}
            `;
        }));
}



/* ---------------- DELETE FORM ---------------- */
function showDeleteForm() {
    clearUI();

    document.getElementById("extra-ui").innerHTML = `
        <div style="display:flex; justify-content:flex-end;">
            <button class="close-btn" onclick="clearUI()">‚úñ</button>
        </div>

        <div class="input-box">
            <label id="delete-label">DELETE path (ex: /upload/test.txt)</label>
            <input type="text" id="delete-path" placeholder="/upload/test.txt">
            <button class="method-btn" onclick="sendDelete()">Delete</button>
        </div>
    `;
}

function sendDelete() {
    const path = document.getElementById("delete-path").value;

    fetch(path, { method: "DELETE" })
        .then(res => res.text().then(t => {
            document.getElementById("response-display").innerHTML = `
                <div style="display:flex; justify-content:flex-end;">
                    <button class="close-btn" onclick="clearUI()">‚úñ</button>
                </div>
                <h3>DELETE ${path} ‚Üí status ${res.status}</h3>
                ${t}
            `;
        }));
}



/* ---------------- CGI FORM ---------------- */
function sendCGI() {
    clearUI();

    document.getElementById("extra-ui").innerHTML = `
        <div style="display:flex; justify-content:flex-end;">
            <button class="close-btn" onclick="clearUI()">‚úñ</button>
        </div>

        <div class="input-box">
            <label id="baguette-label">Euro ‚Üí Baguette</label>
            <input type="text" id="baguette-input" placeholder="3">
            <button class="method-btn" onclick="runBaguetteCGI()">Convert</button>
        </div>
    `;
}

function runBaguetteCGI() {
    const v = document.getElementById("baguette-input").value;
    
    // Get language from localStorage
    const lang = localStorage.getItem("lang") || "fr"; // Default to French if not set

    fetch(`/cgi-bin/baguette.py?euro=${encodeURIComponent(v)}`)
        .then(res => res.text())
        .then(t => {
            const count = t.trim();

            let resultText;
            if (lang === "fr") {
                resultText = `Vous pouvez acheter <b>${count} baguettes</b> avec <b>${v} euros</b> ü•ñ`;
            } else if (lang === "en") {
                resultText = `You can buy <b>${count} baguettes</b> with <b>${v} euros</b> ü•ñ`;
            } else {
                resultText = `ÎãπÏã†Ïùò <b>${v}Ïú†Î°ú</b>Î°ú  <b>${count}Í∞ú</b>Ïùò Î∞îÍ≤åÌä∏Î•º Íµ¨Îß§Ìï† Ïàò ÏûàÏäµÎãàÎã§ ü•ñ`;
            }

            document.getElementById("response-display").innerHTML = `
                <div style="display:flex; justify-content:flex-end;">
                    <button class="close-btn" onclick="clearUI()">‚úñ</button>
                </div>
                <h3>CGI RESULT</h3>
                ${resultText}
            `;
        });
}

</script>

</body>
</html>
