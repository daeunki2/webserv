<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Webserv Â· Red Server (Saucisson)</title>
<style>
    body {
        margin: 0; padding: 0;
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #2f0000, #450000, #3a0000);
        color: #ffe6e6;
    }

    header {
        display: flex; justify-content: space-between; align-items: center;
        padding: 18px 30px;
        border-bottom: 1px solid rgba(255,255,255,0.2);
        background: rgba(80,0,0,0.5);
        backdrop-filter: blur(6px);
    }

    .title { font-size: 26px; font-weight: 600; color: #ffdddd; }

    .lang-switch button {
        background: rgba(255,200,200,0.2);
        border: 1px solid rgba(255,200,200,0.4);
        color: #ffdada;
        padding: 6px 12px;
        border-radius: 8px;
        cursor: pointer; font-size: 12px;
        transition: 0.2s;
    }
    .lang-switch button:hover { background: rgba(255,170,170,0.35); }

    main { max-width: 900px; margin: 40px auto; text-align: center; padding: 0 24px; }

    .card {
        background: rgba(70,0,0,0.5);
        border: 1px solid rgba(255,200,200,0.3);
        padding: 32px; border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        backdrop-filter: blur(8px);
    }

    h2 { margin-top: 0; font-size: 26px; color: #ffe6e6; }
    p { font-size: 15px; opacity: .9; }

    .method-grid {
        margin-top: 30px; display: grid; gap: 20px;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    }

    .method-btn {
        padding: 16px;
        background: rgba(255,150,150,0.15);
        border: 1px solid rgba(255,180,180,0.35);
        color: #ffe6e6;
        border-radius: 14px; font-size: 15px;
        cursor: pointer; transition: 0.2s;
    }
    .method-btn:hover { background: rgba(255,150,150,0.27); }

    .response-box {
        margin-top: 30px;
        padding: 16px;
        background: rgba(255,150,150,0.12);
        border: 1px solid rgba(255,200,200,0.32);
        border-radius: 12px;
        text-align: left;
        white-space: pre-wrap;
        font-family: monospace;
        font-size: 13px;
        color: #ffecec;
    }

    .input-box input[type="text"],
    .input-box input[type="file"] {
        padding: 8px;
        background: rgba(255,230,230,0.1);
        border: 1px solid rgba(255,200,200,0.3);
        border-radius: 6px;
        color: #ffecec;
    }
</style>
</head>

<body>
<header>
    <div class="title" id="title">Serveur Rouge (Saucisson)</div>
    <div class="lang-switch">
        <button onclick="changeLang('fr')">FR</button>
        <button onclick="changeLang('en')">EN</button>
        <button onclick="changeLang('kr')">KR</button>
    </div>
</header>

<main>
    <section class="card">
        <h2 id="subtitle">Bienvenue ðŸŒ­</h2>
        <p id="description">Serveur rouge â€“ Webserv dÃ©mo.</p>

        <div class="method-grid">
            <button class="method-btn" onclick="sendImage()">GET saucisson ðŸŒ­</button>
            <button class="method-btn" onclick="showPostForm()">POST Upload</button>
            <button class="method-btn" onclick="showDeleteForm()">DELETE File</button>
            <button class="method-btn" onclick="sendCGI()">CGI Test</button>
        </div>

        <div id="extra-ui"></div>

        <div class="response-box" id="response-display">
            â†’ Cliquez sur un bouton pour voir la rÃ©ponse HTTP ici.
        </div>
    </section>
</main>

<script>
function changeLang(lang) {
    const t = {
        fr:{title:"Serveur Rouge (Saucisson)",subtitle:"Bienvenue ðŸŒ­",desc:"Serveur rouge â€“ Webserv dÃ©mo.",
            deleteLabel:"DELETE chemin (ex: /upload/test.txt)",
            postLabel:"Upload fichier â†’ POST /upload"},
        en:{title:"Red Server (Saucisson)",subtitle:"Welcome ðŸŒ­",desc:"Red server â€“ Webserv demo.",
            deleteLabel:"DELETE path (ex: /upload/test.txt)",
            postLabel:"Upload file â†’ POST /upload"},
        kr:{title:"ë¹¨ê°„ ì„œë²„ (ì†Œì‹œì†¡)",subtitle:"í™˜ì˜í•©ë‹ˆë‹¤ ðŸŒ­",desc:"ë ˆë“œ ì„œë²„ â€“ Webserv í…ŒìŠ¤íŠ¸ íŽ˜ì´ì§€.",
            deleteLabel:"ì‚­ì œí•  ê²½ë¡œ (ì˜ˆ: /upload/test.txt)",
            postLabel:"ì—…ë¡œë“œ íŒŒì¼ â†’ POST /upload"}
    }[lang];

    document.getElementById("title").innerText = t.title;
    document.getElementById("subtitle").innerText = t.subtitle;
    document.getElementById("description").innerText = t.desc;

    const del=document.getElementById("delete-label");
    const post=document.getElementById("post-label");
    if(del) del.innerText=t.deleteLabel;
    if(post) post.innerText=t.postLabel;
}

function sendImage() {
    fetch("/images/saucisson.jpg", { method: "GET" })
        .then(res => res.blob().then(b => ({status: res.status, blob:b})))
        .then(({status, blob}) => {
            const box = document.getElementById("response-display");

            const url = URL.createObjectURL(blob);

            box.innerHTML = `
                <div style="display:flex; justify-content:flex-end;">
                    <button onclick="resetResponse()" 
                        style="background:transparent; border:none; color:#ffbbbb; font-size:18px; cursor:pointer;">
                        âœ–
                    </button>
                </div>
                <h3>GET /images/saucisson.jpg â†’ status ${status}</h3>
                <img src="${url}" 
                    style="max-width:260px; border-radius:12px; margin-top:10px; box-shadow:0 8px 20px rgba(255,0,0,0.25);">
            `;
        });
}


function sendCGI() {
    fetch("/cgi-bin/test.py")
        .then(r=>r.text().then(t=>{
            document.getElementById("response-display").innerText =
                `CGI GET /cgi-bin/test.py â†’ status ${r.status}\n\n${t}`;
        }));
}

/* POST & DELETE same as blue version */
function showPostForm() {
    document.getElementById("extra-ui").innerHTML =
        `<div class="input-box">
            <label id="post-label">Upload file â†’ POST /upload</label>
            <input id="post-file" type="file">
            <button class="method-btn" onclick="sendPost()">Upload</button>
        </div>`;
}
function sendPost() {
    const f=document.getElementById("post-file").files[0];
    const form=new FormData();
    form.append("file",f);
    fetch("/upload",{method:"POST",body:form})
        .then(r=>r.text().then(t=>{
            document.getElementById("response-display").innerText =
                `POST /upload â†’ ${r.status}\n\n${t}`;
        }));
}
function showDeleteForm() {
    document.getElementById("extra-ui").innerHTML =
        `<div class="input-box">
            <label id="delete-label">DELETE path (ex: /upload/file.txt)</label>
            <input id="delete-path" type="text">
            <button class="method-btn" onclick="sendDelete()">Delete</button>
        </div>`;
}
function sendDelete() {
    const path=document.getElementById("delete-path").value;
    fetch(path,{method:"DELETE"})
        .then(r=>r.text().then(t=>{
            document.getElementById("response-display").innerText =
                `DELETE ${path} â†’ ${r.status}\n\n${t}`;
        }));
}
</script>
</body>
</html>
